<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="printDao">
	<resultMap id="BaseResultMap" type="java.util.HashMap"></resultMap>
	<parameterMap id="BaseParameterMap" type="java.util.HashMap"></parameterMap>

	<insert id="addPinterInfo" parameterMap="BaseParameterMap">
		insert into SC_PRINTER
		(
		PRINTER_PK,
		PRINTER_NAME,
		PRINTER_KEY,
		PRINTER_PAGE_NUMS,
		PRINTER_PAGE_WIDTH,
		RPINTER_SPEED,
		PRINTER_DISHES,
		PRINTER_LEVEL,
		PRINTER_BILL_HEAD,
		INSERT_TIME,
		FK_SHOP,
		PRINTER_TG_TEXT,
		PRINTER_SAMLL_DZ
		)
		values
		(
		#{UUID},
		#{PRINTER_NAME},
		#{PRINTER_KEY},
		#{PRINTER_PAGE_NUMS},
		#{PRINTER_PAGE_WIDTH},
		#{RPINTER_SPEED},
		#{PRINTER_DISHES_STR},
		#{PRINTER_LEVEL},
		#{PRINTER_BILL_HEAD},
		#{INSERT_TIME},
		#{FK_SHOP},
		#{PRINTER_TG_TEXT},
		#{PRINTER_SAMLL_DZ}
		)
	</insert>

	<insert id="addPirntBug" parameterMap="BaseParameterMap">
		insert into SC_PRINT_BUG
		(
		PRINT_BUG_PK,
		FK_PRINT,
		PRINT_WIDTH,
		PRINT_TYPE,
		PRINT_PRICE,
		PRINT_BUG_NUM,
		INSERT_TIME,
		FK_SHOP,
		CREATER
		)
		values
		(
		#{PRINT_BUG_PK},
		#{PRINT_PK},
		#{PRINT_WIDTH},
		#{PRINT_TYPE},
		#{PRINT_PRICE},
		#{PRINT_BUG_NUM},
		#{INSERT_TIME},
		#{FK_SHOP},
		#{CREATER}
		)
	</insert>

	<!-- 查询打印机相关信息 -->
	<select id="loadPrintRelevantList" resultMap="BaseResultMap"
		parameterMap="BaseParameterMap">
		SELECT PRINT_RELEVANT_PK, PRINT_RELEVANT_NAME,
		PRINT_RELEVANT_FPK,
		PRINT_RELEVANT_TYPE FROM SC_PRINT_RELEVANT ORDER BY
		CONVERT(PRINT_RELEVANT_PK, SIGNED)
	</select>

	<select id="findPriceURL" resultMap="BaseResultMap"
		parameterMap="BaseParameterMap">
		SELECT PRINT_PRICE FROM SC_PRINT_PRICR WHERE
		PRINT_PK =
		#{PRINT_PK} AND PRINT_WIDTH = #{PRINT_WIDTH}
		AND PRINT_TYPE =
		#{PRINT_TYPE}
	</select>

	<!-- 查询已购打印机列表 -->
	<select id="loadInUsePrintList" resultMap="BaseResultMap"
		parameterMap="BaseParameterMap">
		SELECT PRINTER_PK, PRINTER_NAME, PRINTER_KEY,
		PRINTER_PAGE_NUMS,
		PRINTER_PAGE_WIDTH, PRINTER_DISHES, PRINTER_LEVEL,
		PRINTER_TG_TEXT,
		PRINTER_SAMLL_DZ
		FROM SC_PRINTER
		<where>
			AND FK_SHOP = #{FK_SHOP}
		</where>
	</select>

	<!-- 查询已购打印机列表 --> 
	<select id="loadPrintList" resultMap="BaseResultMap"
		parameterMap="BaseParameterMap">
		SELECT PRINT_BUG_PK, PRINT_WIDTH FROM SC_PRINT_BUG WHERE
		FK_SHOP = #{FK_SHOP} AND IS_USE = '0'
	</select>

	<!-- 修改已购打印机为在用 -->
	<update id="updatePrinterToUse" parameterMap="BaseParameterMap">
		UPDATE SC_PRINT_BUG SET IS_USE = '1'
		<where>
			AND PRINT_BUG_PK = #{PRINTER_KEY}
		</where>
	</update>
	
	<!-- 查询已购打印机列表 -->
	<select id="loadPrintCount" resultMap="BaseResultMap"
		parameterMap="BaseParameterMap">
		SELECT count(*) as PRINT_COUNT from SC_PRINT_BUG 
	</select>

</mapper>