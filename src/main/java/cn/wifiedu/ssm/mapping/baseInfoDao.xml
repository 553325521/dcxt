<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="baseInfo" >
  <resultMap id="BaseResultMap" type="java.util.HashMap" ></resultMap>
  <parameterMap id="BaseParameterMap" type="java.util.HashMap" ></parameterMap>
 <!--查询学校所属类别  -->
  <select id="findSchoolTypeList" resultMap="BaseResultMap" parameterMap="BaseParameterMap">
    	select 
    		DICTIONARY_PK  SCHOOL_TYPE_PK,
    		DICTIONARY_NAME  SCHOOL_NAME
    	from 
    		sc_core.SC_DICTIONARY  
    	where FK_RULE='182c0cbc8924435ab6773779d9f2f48f'
		and dictionary_code!=99
		and dictionary_code!=341
		and dictionary_code!=342
		ORDER BY DICTIONARY_CODE
  </select>
  
   <!--通过学校所属类别查询所有学校 -->
  <select id="findSchoolByTypeList" resultMap="BaseResultMap" parameterMap="BaseParameterMap">
    	select 
	    	s.SCHOOL_PK  UNIT_PK,
	    	u.UNIT_ABBREVIATION UNIT_NAME,
	    	s.SCHOOL_ADDRESS SCHOOL_ADDRESS
    	from SC_CORE.SC_UNIT_SCHOOL s,SC_CORE.SC_UNIT u 
		where s.SCHOOL_PK=u.UNIT_PK
		and  s.FK_DICTIONARY_SCHOOL_TYPE=#{SCHOOL_TYPE_PK}
		order by nlssort(u.UNIT_ABBREVIATION ,'NLS_SORT=SCHINESE_PINYIN_M')
  </select>
  
  <!-- 通过学校查询所有老师 -->
  <select id="findTeacherBySchoolList" resultMap="BaseResultMap" parameterMap="BaseParameterMap">
  	select 
  		USER_SN,
  		USER_PK 
  	from SC_CORE.SC_USER
	where FK_UNIT=#{UNIT_PK}
	and USER_TYPE=1
	order by nlssort(USER_SN ,'NLS_SORT=SCHINESE_PINYIN_M')
  </select>
  
     <!--通过学校PK查询学校的地址-->
  <select id="findSchoolAddress" resultMap="BaseResultMap" parameterMap="BaseParameterMap">
    	select 
	    	s.SCHOOL_PK  SCHOOL_PK,
	    	u.UNIT_ABBREVIATION SCHOOL_NAME,
	    	s.SCHOOL_ADDRESS SCHOOL_ADDRESS
    	from SC_CORE.SC_UNIT_SCHOOL s,SC_CORE.SC_UNIT u 
		where s.SCHOOL_PK=u.UNIT_PK
		and  s.SCHOOL_PK=#{SCHOOL_PK}
  </select>
  
  <!--查询老师的相关详细信息  -->
<select id="findTeacherInfoByPk" parameterMap="BaseParameterMap" resultMap="BaseResultMap">
	select 
	  u.USER_PK USER_PK,
	  u.USER_SN USER_NAME,
	  u.FK_UNIT UNIT_PK,
	  (select UNIT_NAME from  SC_CORE.SC_UNIT where UNIT_PK=u.FK_UNIT) SCHOOL_NAME,
	  (select UNIT_ADDRESS from SC_CORE.SC_UNIT where UNIT_PK=u.FK_UNIT) SCHOOL_ADDRESS,
  	  t.TEACHER_XBM,
  	  (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK=t.TEACHER_XBM) GENDER,
  	  t.TEACHER_CSRQ DATE_BIRTH,
	  t.TEACHER_ZJZWZGM,
	  (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK= t.TEACHER_ZJZWZGM) PROFESS,
	  t.TEACHER_TXDZYB POSTCODE,
	  t.TEACHER_DZXX  EMAIL,
	  t.TEACHER_SJ MOBILE_PHONE,
	  t.TEACHER_BGDHW  HOME_PHONE,
	  t.TEACHER_BGDHN  UNIT_PHONE,
	  t.TEACHER_SFZJH  ID_CARD,
      t.TEACHER_ZGXL,
      (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK=  t.TEACHER_ZGXL) DEUCATION,
      t.TEACHER_ZGXW,
      (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK=  t.TEACHER_ZGXW) EDU_DEGREE
	from SC_CORE.SC_USER u,SC_CORE.SC_USER_TEACHER t
	where u.USER_PK=t.TEACHER_PK
	and u.USER_PK=#{TEACHER_PK}
</select>

<!--查询当前登录系统老师的相关详细信息  -->
<select id="findNowTeacherInfo" parameterMap="BaseParameterMap" resultMap="BaseResultMap">
		select 
	  u.USER_PK USER_PK,
	  u.USER_SN USER_NAME,
	  u.FK_UNIT UNIT_PK,
	  (select UNIT_NAME from  SC_CORE.SC_UNIT where UNIT_PK=u.FK_UNIT) SCHOOL_NAME,
	  (select UNIT_ADDRESS from SC_CORE.SC_UNIT where UNIT_PK=u.FK_UNIT) SCHOOL_ADDRESS,
  	  t.TEACHER_XBM,
  	  (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK=t.TEACHER_XBM) GENDER,
  	  t.TEACHER_CSRQ DATE_BIRTH,
	  t.TEACHER_ZJZWZGM,
	  (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK= t.TEACHER_ZJZWZGM) PROFESS,
	  t.TEACHER_TXDZYB POSTCODE,
	  t.TEACHER_DZXX  EMAIL,
	  t.TEACHER_SJ MOBILE_PHONE,
	  t.TEACHER_BGDHW  HOME_PHONE,
	  t.TEACHER_BGDHN  UNIT_PHONE,
	  t.TEACHER_SFZJH  ID_CARD,
      t.TEACHER_ZGXL,
      (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK=  t.TEACHER_ZGXL) DEUCATION,
      t.TEACHER_ZGXW,
      (select DICTIONARY_NAME from 	sc_core.SC_DICTIONARY where DICTIONARY_PK=  t.TEACHER_ZGXW) EDU_DEGREE
	from SC_CORE.SC_USER u,SC_CORE.SC_USER_TEACHER t
	where u.USER_PK=t.TEACHER_PK
	and u.USER_PK=#{userInfo.GUID}
</select>
  
</mapper>