<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="teacherResult" >
  <resultMap id="BaseResultMap" type="java.util.HashMap" ></resultMap>
  <parameterMap id="BaseParameterMap" type="java.util.HashMap" ></parameterMap>

  <!-- 查询所有教师成果-->
  <select id="findTeacherResultList" parameterMap="BaseParameterMap" resultMap="BaseResultMap">
  		select 
  			TEACHER_RESULT_PK,
			FK_AUTHOR,
			AUTHOR,
			HARVEST_NAME,
			HARVEST_TYPE,
			PUBLISH_ADDRESS,
			to_char(PUBLISH_DATE,'yyyy-MM-dd') PUBLISH_DATE,
			to_char(CREATE_TIME,'yyyy-MM-dd') CREATE_TIME,
			CREATE_BY,
			DELETE_FLAG
		from 
			SC_TEACHER_RESULT
		where DELETE_FLAG=0
  		<if test=" HARVEST_NAME!= null and  HARVEST_NAME!='' ">
  			and HARVEST_NAME LIKE '%'||#{HARVEST_NAME}||'%'
  		</if>
  		<if test=" START_TIME!= null and  START_TIME!='' ">
  			and PUBLISH_DATE &gt;= to_date(#{START_TIME},'yyyy-mm-dd')
  		</if>
  		<if test=" END_TIME!= null and  END_TIME!='' ">
  			and PUBLISH_DATE &lt;= to_date(#{END_TIME},'yyyy-mm-dd')
  		</if>
  </select>

  <select id="findTeacherResultListSize" parameterMap="BaseParameterMap" resultType="java.lang.Integer">
	  	select 
	  		count(*)
	  	from 
	  		SC_TEACHER_RESULT
		where DELETE_FLAG=0
  		<if test=" HARVEST_NAME!= null and  HARVEST_NAME!='' ">
  			and HARVEST_NAME LIKE '%'||#{HARVEST_NAME}||'%'
  		</if>
  		<if test=" START_TIME!= null and  START_TIME!='' ">
  			and PUBLISH_DATE &gt;= to_date(#{START_TIME},'yyyy-mm-dd')
  		</if>
  		<if test=" END_TIME!= null and  END_TIME!='' ">
  			and PUBLISH_DATE &lt;= to_date(#{END_TIME},'yyyy-mm-dd')
  		</if>
  </select> 
 <!-- 通过ID查询教师成果详情 -->
  <select id="findTeacherResultById" parameterMap="BaseParameterMap" resultMap="BaseResultMap">
  		select 
  			TEACHER_RESULT_PK,
			FK_AUTHOR,
			AUTHOR,
			HARVEST_NAME,
			HARVEST_TYPE,
			PUBLISH_ADDRESS,
			to_char(PUBLISH_DATE,'yyyy-MM-dd') PUBLISH_DATE,
			to_char(CREATE_TIME,'yyyy-MM-dd') CREATE_TIME,
			CREATE_BY,
			DELETE_FLAG
		from 
			SC_TEACHER_RESULT
		where TEACHER_RESULT_PK=#{TEACHER_RESULT_PK}
  </select>
 
 <!--添加教师成果  -->
 <insert id="insertTeacherResult" parameterMap="BaseParameterMap">
  	insert into SC_TEACHER_RESULT 
                          	  	(
	  		TEACHER_RESULT_PK,
			FK_AUTHOR,
			AUTHOR,
			HARVEST_NAME,
			HARVEST_TYPE,
			PUBLISH_ADDRESS,
			PUBLISH_DATE,
			CREATE_TIME,
			CREATE_BY,
			DELETE_FLAG	
	  	)
	  	values(
	  		#{UUID},
	  		#{USER_PK},
	  		#{AUTHOR},
	  		#{HARVEST_NAME},
	  		#{HARVEST_TYPE},
	  		#{PUBLISH_ADDRESS},
	  		to_date(#{PUBLISH_DATE},'yyyy-MM-dd'),
	  		sysdate,
 			#{userInfo.GUID},
 			#{DELETE_FLAG}
	  	)
 </insert>
 <!-- 修改教师成果 -->
 <update id='updateTeacherResult' parameterMap="BaseParameterMap">
 	update SC_TEACHER_RESULT
 		set 
 			FK_AUTHOR=#{USER_PK},
			AUTHOR=#{AUTHOR},
			HARVEST_NAME=#{HARVEST_NAME},
			HARVEST_TYPE=#{HARVEST_TYPE},
			PUBLISH_ADDRESS=#{PUBLISH_ADDRESS},
			PUBLISH_DATE=to_date(#{PUBLISH_DATE},'yyyy-MM-dd'),
			UPDATE_TIME=sysdate,
			UPDATE_BY=#{userInfo.GUID}
	where TEACHER_RESULT_PK=#{TEACHER_RESULT_PK}		
 </update>
 <!--通过PK删除  -->
 <update id="deleteTeacherResult" parameterMap="BaseParameterMap">
 	update  SC_TEACHER_RESULT
 		set DELETE_FLAG=1
 	where TEACHER_RESULT_PK=#{TEACHER_RESULT_PK}
 </update>
</mapper>